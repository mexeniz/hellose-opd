<!DOCTYPE html>
<% layout('layout') -%>

<!-- Heading -->
<md-content flex id="content">
<md-toolbar>
  <div class="md-toolbar-tools">
    <md-button class="md-icon-button" ng-click="toggleNav('left')" hide-gt-md aria-label="Menu">
      <md-icon md-font-library="material-icons">menu</md-icon>
    </md-button>
    <h1 class="title">
      <span>ประวัติผู้ป่วย</span>
    </h1>
  </div>
</md-toolbar>

<!-- Content -->
<md-content ng-controller="InfoCtrl" ng-init="init('<%= patient_id %>')" flex layout-padding>
    <md-tabs md-dynamic-height md-border-bottom>
      <md-tab label="ข้อมูลส่วนตัว">
        <md-content class="md-padding">
          <div class="h1-th">ข้อมูลส่วนตัว
          <md-button class="md-fab md-primary" ng-click="showEditProfile($event)">
            <md-icon md-font-library="material-icons">create</md-icon>
          </md-button>
          </div>
          <md-list>
            <md-list-item class="md-2-line">
              <md-icon md-font-library="material-icons" class="material-icons">face</md-icon>
              <div class="md-list-item-text">
                <div class="h3-th">ชื่อจริง-นามสกุล</div>
                <div class="h2-th">{{patient.firstname}}  {{patient.lastname}}</div>
              </div>
            </md-list-item>
            <md-list-item class="md-2-line">
              <md-icon md-font-library="material-icons" class="material-icons">assignment_ind</md-icon>
              <div class="md-list-item-text">
                <div class="h3-th">รหัสผู้ป่วย</div>
                <div class="h2-th">{{patient.patient_id}}</div>
              </div>
            </md-list-item>
            <md-divider></md-divider>
            <md-list-item class="md-2-line">
              <md-icon md-font-library="material-icons" class="material-icons">accessibility</md-icon>
              <div class="md-list-item-text">
                <div class="h3-th">รหัสประจำตัวประชาชน</div>
                <div class="h2-th">{{patient.ssn}}</div>
              </div>
            </md-list-item>

            <md-divider></md-divider>
            <md-list-item class="md-2-line">
              <md-icon md-font-library="material-icons" class="material-icons">wc</md-icon>
              <div class="md-list-item-text">
                <div class="h3-th">เพศ</div>
                <div class="h2-th">{{patient.gender}}</div>
              </div>
            </md-list-item>

            <md-divider></md-divider>
            <md-list-item class="md-2-line">
              <md-icon md-font-library="material-icons" class="material-icons">cake</md-icon>
              <div class="md-list-item-text">
                <div class="h3-th">อายุ</div>
                <div class="h2-th">{{patient.age}}</div>
              </div>
            </md-list-item>
            
            <md-divider></md-divider>
            <md-list-item class="md-2-line">
              <md-icon md-font-library="material-icons" class="material-icons">local_hospital</md-icon>
              <div class="md-list-item-text">
                <div class="h3-th">หมู่เลือด</div>
                <div class="h2-th">{{patient.blood_type}}</div>
              </div>
            </md-list-item>          

            <md-divider></md-divider>
            <md-list-item class="md-2-line">
              <md-icon md-font-library="material-icons" class="material-icons">today</md-icon>
              <div class="md-list-item-text">
                <div class="h3-th">วันเกิด</div>
                <div class="h2-th">{{patient.birthdate | date:medium}}</div>
              </div>
            </md-list-item>

            <md-divider></md-divider>
            <md-list-item class="md-2-line">
              <md-icon md-font-library="material-icons" class="material-icons">call</md-icon>
              <div class="md-list-item-text">
                <div class="h3-th">เบอร์โทรศัพท์</div>
                <div class="h2-th">{{patient.tel_number}}</div>
              </div>
            </md-list-item>

            <md-divider></md-divider>
            <md-list-item class="md-2-line">
              <md-icon md-font-library="material-icons" class="material-icons">mail_outline</md-icon>
              <div class="md-list-item-text">
                <div class="h3-th">อีเมลล์</div>
                <div class="h2-th">{{patient.email}}</div>
              </div>
            </md-list-item>

            <md-divider></md-divider>
            <md-list-item class="md-2-line">
              <md-icon md-font-library="material-icons" class="material-icons">place</md-icon>
              <div class="md-list-item-text">
                <div class="h3-th">ที่อยู่</div>
                <div class="h2-th">{{patient.address}}</div>
              </div>
            </md-list-item>


           </md-list>
          
        </md-content>
      </md-tab>
      <md-tab label="ข้อมูลทางการแพทย์">
        <md-content class="md-padding">
          <div class="h1-th">ข้อมูลทางกายภาพ
          <md-button class="md-fab md-primary" ng-click="showPhysicalRecordForm($event,'create',{})">
            <md-icon md-font-library="material-icons">add</md-icon>
          </md-button></div>
          <br>
          <md-data-table-container>
            <table md-data-table>
              <thead>
                <tr>
                  <th>วันที่</th>
                  <th>น้ำหนัก</th>
                  <th>ส่วนสูง</th>
                  <th>ความดันโลหิต</th>
                  <th>อัตราการเต้นหัวใจ</th>
                  <th>อุณหภูมิร่างกาย</th>
                  <th>การจัดการ</th>
                </tr>
              </thead>
              <tbody ng-repeat="physicalRecord in physicalRecordList">
                <tr>
                  <td>{{physicalRecord.date | date : 'medium'}}</td>
                  <td>{{physicalRecord.weight}}</td>
                  <td>{{physicalRecord.height}}</td>
                  <td>{{physicalRecord.blood_pressure}}</td>
                  <td>{{physicalRecord.pulse}}</td>
                  <td>{{physicalRecord.temperature}}</td>
                  <td>
                    <md-button class="md-fab md-mini md-primary" ng-click="showPhysicalRecordForm($event,'edit',physicalRecord)">
                      <md-icon md-font-library="material-icons">mode_edit</md-icon>
                    </md-button>
                    <md-button class="md-fab md-mini md-warn"  ng-click="removePhysicalRecord(physicalRecord, $index)">
                      <md-icon md-font-library="material-icons">delete</md-icon>
                    </md-button>
                  </td>
                </tr>
              </tbody>
            </table>
          </md-data-table-container>
          
        </md-content>
      </md-tab>
      <md-tab label="ประวัติการรักษา">
        <md-content class="md-padding">
          <div class="h1-th">ประวัติการรักษา
          <md-button class="md-fab md-primary" ng-click="showMedicalRecordForm($event,'create',{})">
            <md-icon md-font-library="material-icons">add</md-icon>
          </md-button></div>
          <br>
           <md-data-table-container>
            <table md-data-table>
              <thead>
                <tr>
                  <th>วันที่</th>
                  <th>แพทย์</th>
                  <th>โรค</th>
                  <th>อาการ</th>
                  <th>การจัดการ</th>
                </tr>
              </thead>
              <tbody ng-repeat="medicalRecord in medicalRecordList">
                <tr>
                  <td>{{medicalRecord.date | date: 'medium'}}</td>
                  <td>{{medicalRecord.doctor}}</td>
                  <td>
                    <span ng-repeat="diseaseItem in medicalRecord.diseases">{{diseaseItem}} </span>
                    <span ng-show="medicalRecord.diseases.length === 0">-</span>
                  </td>
                  <td>{{medicalRecord.symptoms}}</td>
                  <td>
                    <md-button class="md-fab md-mini md-primary" ng-click="showMedicalRecordForm($event,'edit',medicalRecord)">
                      <md-icon md-font-library="material-icons">mode_edit</md-icon>
                    </md-button>
                    <md-button class="md-fab md-mini md-warn" ng-click="removeMedicalRecord(medicalRecord, $index)">
                      <md-icon md-font-library="material-icons">delete</md-icon>
                    </md-button>
                  </td>
                </tr>
              </tbody>
            </table>
          </md-data-table-container>

        </md-content>
      </md-tab>
      <md-tab label="ประวัติการรับยา">
        <md-content class="md-padding">
          <div class="h1-th">ประวัติการรับยา
          <md-button class="md-fab md-primary" ng-click="showPrescription($event)">
            <md-icon md-font-library="material-icons">add</md-icon>
          </md-button></div>

          <md-card >
            <md-card-content flex="50">
              <md-list>
                <md-list-item class="md-2-line">
                  <md-icon md-font-library="material-icons">adb</md-icon>
                  <div class="md-list-item-text">
                    <div class="h3-th">ยาที่แพ้</div>
                    <span class="h2-th" ng-repeat="al in allergy" >
                      {{al+" "}} 
                     </span>
                  </div>
                </md-list-item>
              </md-list>
            </md-card-content>
          </md-card>
          <md-data-table-container>
            <table md-data-table>
              <thead>
                <tr>
                  <th>วันที่</th>
                  <th>สถานะ</th>
                  <th>แพทย์ผู้จ่าย</th>
                  <th>การจัดการ</th>
                </tr>
              </thead>
              <tbody ng-repeat="p in prescriptionList">
                <tr>
                  <td >{{ p.date | date: 'medium' }}</td>
                  <td ng-style="{'color':p.status === 'รอการจ่าย'?'red':'green'}">{{p.status}}</td>
                  <td>{{p.doctor}}</td>
                  <td>
                    <md-button class="md-raised md-primary" ng-click="showPresDetail($event,p)">รายละเอียด</md-button>
                  </td>
                </tr>
              </tbody>
            </table>
          </md-data-table-container>

           </md-list>
        </md-content>
      </md-tab>
      
    </md-tabs>
</md-content>